<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta name="generator" content="nico 0.5.1">
    <meta name="theme" content="autumn 0.1">
    <title>ak47 - alipay H5App developer kits | AM - 移动Web开放解决方案</title>
    <link rel="stylesheet" href="../static/1140.css"/>
    <link rel="stylesheet" href="../static/wiki.css"/>
    <link rel="stylesheet" href="../static/syntax.css"/>
</head>
<body>
<div class="goTop">
    <span>Go TOP</span>
</div>
<div class="wrap">
    <div class="main">
        <div class="header">
            <div class="slogan row">
                <a href="../default.html"><img src="https://i.alipayobjects.com/i/ecmng/png/201406/2m8Ebk4eZh.png"
                                               class="slogan-logo" alt="alipay"/></a>
                <span>移动Web解决方案</span>
                <span class="search">
                   <!--<input type="text" id="search" placeholder="搜点东西...">-->
                </span>
                <button type="button" class="navbar-toggle">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>

            </div>
            <div class="header-nav">
                <div class="navigation row-n">
                    
<ul class="nav">
    <li>
        <a  archiveId = "about"
        href="../about/about.html">
        关于AM </a>
        
    </li>
    
    <li>
        <a  archiveId = "amg"
        href="../amg/dev-guild.html">
        开发指南 </a>
        
        <ul class="nav-sub">
            <li>
                <a href="../amg/dev-guild.html">移动开发规范指南</a>
            </li>
            
            <li>
                <a href="../amg/mobile-platform-grade.html">移动Web分级标准</a>
            </li>
            
            <li>
                <a href="../amg/dev-exp-doc.html">移动开发经验谈</a>
            </li>
            
            <li>
                <a href="../amg/website-guild.html">移动建站指南</a>
            </li>
            
            <li>
                <a href="https://github.com/am-team/amDoc/../">Github</a>
            </li>
            
        </ul>
        
    </li>
    
    <li>
        <a  archiveId = "amui"
        href="../amui/about.html">
        AMUI </a>
        
        <ul class="nav-sub">
            <li>
                <a href="../amui/about.html">关于AMUI</a>
            </li>
            
            <li>
                <a href="../amui/amui-doc.html">接口文档</a>
            </li>
            
            <li>
                <a href="https://github.com/am-team/amUI/../">Github</a>
            </li>
            
        </ul>
        
    </li>
    
    <li>
        <a  archiveId = "amj"
        href="../amj/about.html">
        AMJ </a>
        
        <ul class="nav-sub">
            <li>
                <a href="../amj/about.html">关于AMJ</a>
            </li>
            
            <li>
                <a href="../amj/aj-doc.html">接口文档</a>
            </li>
            
            <li>
                <a href="https://github.com/am-team/amJS/../">Github</a>
            </li>
            
        </ul>
        
    </li>
    
    <li>
        <a  archiveId = "amw"
        href="../amw/about.html">
        AMW </a>
        
        <ul class="nav-sub">
            <li>
                <a href="../amw/about.html">关于AMW</a>
            </li>
            
            <li>
                <a href="../amw/aw-doc.html">接口文档</a>
            </li>
            
            <li>
                <a href="https://github.com/am-team/amWidget/../">Github</a>
            </li>
            
        </ul>
        
    </li>
    
    <li>
        <a  archiveId = "H5Container"
        href="../h5container/about.html">
        H5Container </a>
        
        <ul class="nav-sub">
            <li>
                <a href="../h5container/about.html">关于H5Container</a>
            </li>
            
            <li>
                <a href="../h5container/ab-doc.html">Bridge组件（内测中）</a>
            </li>
            
            <li>
                <a href="../h5container/jsapi-doc.html">JSAPI 接口文档</a>
            </li>
            
        </ul>
        
    </li>
    
    <li>
        <a  archiveId = "H5APP"
        href="about.html">
        H5APP </a>
        
        <ul class="nav-sub">
            <li>
                <a href="about.html">关于H5App</a>
            </li>
            
            <li>
                <a href="ak47-doc.html">ak47</a>
            </li>
            
        </ul>
        
    </li>
    
    <li>
        <a  archiveId = "wiki"
        href="../">
        知识库 </a>
        
        <ul class="nav-sub">
            <li>
                <a href="../wiki/bookmark.html">收藏阁</a>
            </li>
            
        </ul>
        
    </li>
    
    <li>
        <a  archiveId = "issue"
        href="https://github.com/am-team/amWiki/issues/new/../">
        提建议 </a>
        
    </li>
    
</ul>

                </div>
            </div>
        </div>
        
<div class="row mar">
    <div class="threecol meta">
    </div>
    
 
    <div class="ninecol content">
        <div class="document">
            <div class="post-header">
                <h2 class="document-title">ak47 - alipay H5App developer kits</h2>

                <div class="post-meta">
                    <!--<span></span> /-->
                    <time datetime="2014-06-25">2014-06-25</time>
                </div>
            </div>
            <div class="entry-content">
                <h2 id="说明">说明</h2><p>ak47是支付宝离线h5app开发的一套工具集，它将整个h5app开发周期中各个环节用到的实用工具集成在一起</p>
<p>使用该工具集能大大提升h5app开发效率</p>
<h2 id="安装">安装</h2><h3 id="升级nodejs">升级Nodejs</h3><p><strong>已知在osx 10.9下，node@0.10.22以下版本运行gulp watch功能会报错，请升级最新版node:</strong></p>
<pre>$ sudo npm cache clean –f
$ sudo npm install -g n
$ sudo n stable</pre><h3 id="安装ak47">安装ak47</h3><pre>$ npm install ak47 -g</pre><p>有时候会由于GFW的原因导致报错<code>npm ERR! registry error parsing json</code>，这时候请先使用</p>
<pre>npm config set registry http://registry.cnpmjs.org</pre><p>还有问题的话请google解决办法，GFW你懂的。。</p>
<h2 id="初始化一个新h5app项目">初始化一个新H5App项目</h2><h3 id="启动方式：ak47-init">启动方式：<code>ak47 init</code></h3><pre>$ mkdir h5app-demo
$ cd h5app-demo
$ ak47 init

//开始输入初始化项目参数

appid: 20000123                         //应用ID
name:(H5App) demo                       //应用名称
version:(1.0.0.0)                       //应用版本号
url:(/www/index.htm)                    //应用启动页
descriptor: test ak47                   //应用简介

# H5App init success!</pre><p>输入时可直接回车，将会以括号内的值作为默认值。<br/>
通过初始化的项目参数将会在项目根目录自动生成一个Manifest.xml文件，后续可手工修改内容。</p>
<p>www目录下将自动生成一个demo项目，可直接删除或稍作参考。</p>
<h3 id="使用一个现有h5app项目">使用一个现有H5App项目</h3><p>假设有一个H5App标准项目，路径为
<code>/Users/haibinzhb/Project/alipayProject/h5app-demo</code></p>
<p>那么直接cd到项目根目录</p>
<pre>cd /Users/haibinzhb/Project/alipayProject/h5app-demo</pre><h2 id="开启本地静态http服务器">开启本地静态HTTP服务器</h2><h3 id="启动方式：ak47-server">启动方式：<code>ak47 server</code></h3><p>支持通过 --p 参数来自定义HTTP虚拟服务器端口号，默认为3000
支持通过 --watch 参数打开watch功能</p>
<pre>$ ak47 server --watch --p 3001

# project = /Users/haibinzhb/Project/alipayProject/h5app-demo
# webServer(web页面预览地址) = http://10.15.133.180:3001/
# qrScheme(二维码服务) = http://10.15.133.180:3001/qr
# listening... do not exit!</pre><p>执行后将打印出三个结果:</p>
<ol>
<li><p><code>project</code>为当前项目绝对路径。</p>
</li>
<li><p><code>webServer</code>为本地web服务器地址。</p>
</li>
<li><p><code>qrScheme</code>为二维码拍码地址，PC端打开后出现两个二维码，分别可以在移动端拍码后用原生浏览器或支付宝钱包打开。</p>
</li>
</ol>
<p>默认启动页为自动获取自Manifest.xml文件内的url值，一般为index.htm。同时还会获取showTitleBar和showToolBar的值作为启动参数。</p>
<p><strong>同时可通过--watch参数启用watch功能，PC端编辑静态资源文件(<em>.htm、</em>.html、<em>.css、</em>.js)并保存后，调试页会自动刷新。</strong></p>
<h2 id="开启远程调试控制台-改造自weinre">开启远程调试控制台(改造自weinre)</h2><h3 id="启动方式-ak47-debug">启动方式: <code>ak47 debug</code></h3><p>支持通过 --p 参数来自定义HTTP虚拟服务器端口号，默认为3000
支持通过 --watch 参数打开watch功能</p>
<p>集成weinre功能，原理可参考<a href="http://people.apache.org/~pmuellr/weinre/docs/latest/Home.html">传送门</a>，ak47的weinre默认端口号为3119，可使用weinre的原生参数 --httpPort自定义。</p>
<p>开启远程调试控制台功能后，同时会开启本地静态HTTP服务器。并且url地址将自动识别为当前局域网的IP地址。</p>
<h4 id="请保持移动端设备和pc的网络处于同一环境下">请保持移动端设备和PC的网络处于同一环境下</h4><pre>$ ak47 debug --watch --p 3001

# project = /Users/haibinzhb/Project/alipayProject/h5app-demo

# debugPath(远程调试控制台地址) = http://10.15.133.180:3001/debug
# webServer(web页面预览地址) = http://10.15.133.180:3001/
# qrScheme(二维码服务) = http://10.15.133.180:3001/qr
# debugScript(非本地页面需手动插入脚本) = &lt;script src=&quot;http://10.15.134.119:3119/target/target-script-min.js#anonymous&quot;&gt;&lt;/script&gt;

# listening... do not exit!</pre><h3 id="调试教程">调试教程</h3><p><strong>如果是调试ak47搭建的本地站点，ak47将会自动为所有被访问的.htm或.html后缀的页面内嵌入远程调试代码，开发者无需手动加入。</strong></p>
<p><strong>如果是需要调试在线网站(即非本地服务器网址)的页面，需要手动在被调试页面源码内加入debugScript的内容(即一个script标签)</strong></p>
<p><strong>同时可通过--watch参数启用watch功能，PC端编辑静态资源文件(<em>.htm、</em>.html、<em>.css、</em>.js)并保存后，调试页会自动刷新。</strong></p>
<ol>
<li>PC端浏览器打开<code>debugPath</code>地址</li>
<li>debugPath地址会出现两个二维码，分别可以在移动端拍码后用原生浏览器或支付宝钱包打开。</li>
</ol>
<p>默认启动页为自动获取自Manifest.xml文件内的url值，一般为index.htm。同时还会获取showTitleBar和showToolBar的值作为启动参数。</p>
<p>qrScheme地址为专门的扫码地址</p>
<p>weinre的调试界面完全类似chrome的调试台</p>
<h4 id="注：如果出现远程调试无反应的情况，一般是由于连接超时或断开，请重新刷新手机端页面或远程控制台页面即可。">注：如果出现远程调试无反应的情况，一般是由于连接超时或断开，请重新刷新手机端页面或远程控制台页面即可。</h4><h3 id="后续计划">后续计划</h3><ol>
<li>服务端数据mock功能</li>
<li>客户端bridge接口mock功能</li>
</ol>
<h2 id="离线项目打包">离线项目打包</h2><h3 id="启动方式-ak47-pkg">启动方式: <code>ak47 pkg</code></h3><p>支持两种命令<code>ak47 pkg</code>或<code>ak47 package</code>
执行后会提示当前版本号并允许输入新版本号，可直接回车跳过；或输入新版本号，将自动更新Manifest.xml内的版本号。
还能通过输入environ参数来增加amr包的运行环境标识，默认为dev</p>
<p>打包工具将会自动获取Manifest.xml文件内的appid和版本号来生成amr包文件名</p>
<pre>$ ak47 pkg

version:(1.0.0.0) 1.1.0.0
environ:(dev) rc

# archiving...
# packed at /Users/haibinzhb/Project/alipayProject/h5app-demo/package/20000127-1.1.0.0_rc.amr</pre><h3 id="后续计划">后续计划</h3><ol>
<li>自动压缩js和css文件</li>
<li>优化加签验签逻辑，不再强绑定为支付宝H5App签名功能，实现一个包可以同时用于其他无线端产品线</li>
</ol>
<h2 id="其他功能功能开发中">其他功能功能开发中</h2><pre>$ ak47 publish    //发布到指定环境</pre>
            </div>
        </div>
    </div>
</div>

 
 
    </div>
</div>
<!--<div class="logo">-->
<!--&lt;!&ndash;<div class="logo-inner"></div>&ndash;&gt;-->
<!--</div>-->
<div class="footer">
    <div class="grid-990 sitelink fn-clear" coor="sitelink" role="contentinfo">
        <ul class="ui-link fn-clear">
            <!-- XT:支付宝首页/默认频道/支付宝新首页开始:www.alipay.com/i/indexb.vm -->
            <li class="ui-link-item"><a href="http://ab.alipay.com/i/index.htm" target="_blank" title="关于支付宝"
                                        seed="grid990-link" smartracker="on">关于支付宝</a></li>
            <li class="ui-link-item"><a href="http://blog.alipay.com/" target="_blank" title="官方博客"
                                        seed="grid990-linkT1" smartracker="on">官方博客</a></li>
            <li class="ui-link-item"><a href="http://job.alipay.com/index.php" target="_blank" title="诚征英才"
                                        seed="grid990-linkT2" smartracker="on">诚征英才</a></li>
            <li class="ui-link-item"><a href="https://open.alipay.com/index.htm" target="_blank" title="开放平台"
                                        seed="grid990-linkT3" smartracker="on">开放平台</a></li>
            <li class="ui-link-item"><a href="http://ab.alipay.com/i/lianxi.htm" target="_blank" title="联系我们"
                                        seed="grid990-linkT4" smartracker="on">联系我们</a></li>
            <li class="ui-link-item"><a href="http://fun.alipay.com/sitemap/index.htm" target="_blank" title="网站地图"
                                        seed="grid990-linkT5" smartracker="on">网站地图</a></li>
            <li class="ui-link-item"><a href="http://global.alipay.com/ospay/home.htm" target="_blank"
                                        title="International Business" seed="grid990-International-Business"
                                        smartracker="on">International Business</a></li>
            <li class="ui-link-item ui-link-item-last"><a href="http://ab.alipay.com/i/jieshao.htm#en" target="_blank"
                                                          title="About Alipay" seed="grid990-About-Alipay"
                                                          smartracker="on">About Alipay</a></li>
            <!-- XT:支付宝首页/默认频道/支付宝新首页结束:www.alipay.com/i/indexb.vm -->        </ul>
        <ul class="ui-link fn-clear">
            <!-- XT:支付宝首页/默认频道/支付宝新首页开始:www.alipay.com/i/indexb.vm -->
            <li class="ui-link-item"><a href="http://page.1688.com/shtml/about/ali_group1.shtml" target="_blank"
                                        title="阿里巴巴集团" seed="grid990-linkT7" smartracker="on">阿里巴巴集团</a></li>
            <li class="ui-link-item"><a href="http://www.alibaba.com/" target="_blank" title="阿里巴巴国际站"
                                        seed="grid990-linkT8" smartracker="on">阿里巴巴国际站</a></li>
            <li class="ui-link-item"><a href="http://www.1688.com/" target="_blank" title="阿里巴巴中国站"
                                        seed="grid990-linkT9" smartracker="on">阿里巴巴中国站</a></li>
            <li class="ui-link-item"><a href="http://www.aliexpress.com/" target="_blank" title="全球速卖通"
                                        seed="grid990-linkT10" smartracker="on">全球速卖通</a></li>
            <li class="ui-link-item"><a href="http://www.taobao.com/" target="_blank" title="淘宝网" seed="grid990-linkT11"
                                        smartracker="on">淘宝网</a></li>
            <li class="ui-link-item"><a href="http://www.tmall.com/" target="_blank" title="天猫" seed="grid990-linkT12"
                                        smartracker="on">天猫</a></li>
            <li class="ui-link-item"><a href="http://ju.taobao.com" target="_blank" title="聚划算" seed="grid990-linkT13"
                                        smartracker="on">聚划算</a></li>
            <li class="ui-link-item"><a href="http://www.etao.com/?tbpm=t" target="_blank" title="一淘"
                                        seed="grid990-linkT14" smartracker="on">一淘</a></li>
            <li class="ui-link-item"><a href="http://www.alimama.com/index.htm" target="_blank" title="阿里妈妈"
                                        seed="grid990-linkT15" smartracker="on">阿里妈妈</a></li>
            <li class="ui-link-item"><a href="http://trip.taobao.com/" target="_blank" title="淘宝旅行"
                                        seed="grid990-linkT16" smartracker="on">淘宝旅行</a></li>
            <li class="ui-link-item"><a href="http://www.xiami.com/" target="_blank" title="虾米" seed="grid990-linkT17"
                                        smartracker="on">虾米</a></li>
            <li class="ui-link-item"><a href="http://www.aliyun.com/" target="_blank" title="阿里云计算"
                                        seed="grid990-linkT18" smartracker="on">阿里云计算</a></li>
            <li class="ui-link-item"><a href="http://www.yunos.com/" target="_blank" title="云OS" seed="grid990-linkT19"
                                        smartracker="on">云OS</a></li>
            <li class="ui-link-item"><a href="http://www.net.cn/" target="_blank" title="万网" seed="grid990-linkT20"
                                        smartracker="on">万网</a></li>
            <li class="ui-link-item"><a href="https://www.alipay.com/" target="_blank" title="支付宝"
                                        seed="grid990-linkT21" smartracker="on">支付宝</a></li>
            <li class="ui-link-item ui-link-item-last"><a href="https://www.laiwang.com/" target="_blank" title="来往"
                                                          seed="grid990-linkT22" smartracker="on">来往</a></li>
            <!-- XT:支付宝首页/默认频道/支付宝新首页结束:www.alipay.com/i/indexb.vm -->        </ul>
        <ul class="ui-link ui-link-bottom fn-clear">
            <li class="ui-link-item ui-link-item-last">支付宝版权所有 2004-2014 <a
                    href="http://fun.alipay.com/certificate/jyxkz.htm" target="_blank" seed="grid990-linkT6"
                    smartracker="on">ICP证: 浙B2-20120045</a></li>
        </ul>

    </div>
</div>
</body>
<script src="http://static.alipayobjects.com/seajs/1.2.1/sea.js" data-main="../static/global.js"></script>
<script>
    seajs.config({
        alias: {
            "$": 'jquery/jquery/1.7.2/jquery'
        }
    });
    //        seajs.use(['arale/autocomplete/1.2.3/autocomplete','$'], function(AutoComplete,$) {
    //          $('.logo').click(function (e) {
    //              $('body,html').animate({
    //                scrollTop: 0
    //          }, 500);
    //            e.preventDefault();
    //          });
    //            new AutoComplete({
    //                trigger: '#search',
    //                filter:"stringMatch",
    //                dataSource: [
    //"../about/about.html","../amg/dev-exp-doc.html","../amg/dev-guild.html","../amg/mobile-platform-grade.html","../amg/website-guild.html","../amj/about.html","../amj/aj-doc.html","../amui/about.html","../amui/amui-doc.html","../amw/about.html","../amw/aw-doc.html","about.html","ak47-doc.html","../h5container/ab-doc.html","../h5container/about.html","../h5container/jsapi-doc.html","../wiki/bookmark.html",
    //                ]
    //            }).render().on('itemSelect',function  (data) {
    //              window.location = data.matchKey;
    //            });
    //        });
    //解决nav中包含http或者https时候的bug
    seajs.use("$", function ($) {
//            console.log($);
        $('.nav a').on("click", function (e) {
//            e.preventDefault();
            var link = $(this).attr("href");
//            console.log(link);
            if (link.indexOf("http") == 0) {
                $(this).attr("target", "_blank");
                $(this).attr("href",link.replace("../", ""));
            }
        });
    });
</script>
</html>